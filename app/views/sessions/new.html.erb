<!-- Google Material Symbols を1回だけ読み込む -->
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />

<body class="login-page">
<div class="login-container">
  <h2 class="login-title">教員用ログイン</h2>

  <% if flash[:alert] %>
    <p class="login-alert"><%= flash[:alert] %></p>
  <% end %>

  <%= form_with url: login_path, local: true, data: { turbo: false }, html: { class: "login-form" } do |f| %>

    <!-- アカウント名 -->
    <div class="form-group">
      <div class="label-with-icon">
        <span class="material-symbols-outlined form-icon">account_circle</span>
        <%= f.label :account_name, "アカウント名", for: "account_name_field", class: "form-label" %>
      </div>
      <%= f.text_field :account_name, class: "form-input", id: "account_name_field" %>
    </div>

    <!-- パスワード -->
    <div class="form-group password-group">
      <div class="label-with-icon">
        <span class="material-symbols-outlined form-icon">lock</span>
        <%= f.label :password, "パスワード", for: "password_field", class: "form-label" %>
      </div>

      <div class="password-wrapper">
        <%= f.password_field :password, class: "form-input", id: "password_field" %>

        <span id="toggle-password" class="material-symbols-outlined toggle-password"
              data-open="visibility" data-close="visibility_off">
          visibility_off
        </span>
      </div>
    </div>

    <div class="form-group">
      <%= f.submit "ログイン", class: "form-button" %>
    </div>
  <% end %>

  <hr class="divider">

  <%= button_to "生徒としてログイン", guest_login_path, method: :post, class: "guest-button" %>
</div>
</body>

<script>
document.addEventListener("turbo:load", function() {
  const toggle = document.getElementById("toggle-password");
  const password = document.getElementById("password_field");

  if (toggle && password) {
    toggle.addEventListener("click", () => {
      if (password.type === "password") {
        password.type = "text";
        toggle.textContent = toggle.dataset.open; // visibility
      } else {
        password.type = "password";
        toggle.textContent = toggle.dataset.close; // visibility_off
      }
    });
  }
});
</script>
